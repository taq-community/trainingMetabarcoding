<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   viewBox="0 0 900 1600"
   width="900"
   height="1600"
   version="1.1"
   id="svg28"
   sodipodi:docname="barque_pipeline.svg"
   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview28"
     pagecolor="#ffffff"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:zoom="0.85477865"
     inkscape:cx="473.22193"
     inkscape:cy="482.58108"
     inkscape:window-width="1486"
     inkscape:window-height="891"
     inkscape:window-x="0"
     inkscape:window-y="0"
     inkscape:window-maximized="1"
     inkscape:current-layer="svg28" />
  <defs
     id="defs1">
    <style
       id="style1">
      .step { fill: #fdfdfd; stroke: #004f6b; stroke-width: 2; rx: 14; ry: 14; }
      .optional { stroke-dasharray: 10 6; }
      .title { font: bold 22px &quot;DejaVu Sans&quot;, Arial, sans-serif; fill: #012b36; text-anchor: middle; }
      .label { font: 17px &quot;DejaVu Sans&quot;, Arial, sans-serif; fill: #033a48; text-anchor: middle; }
      .note { font: italic 14px &quot;DejaVu Sans&quot;, Arial, sans-serif; fill: #335660; text-anchor: middle; }
      .arrow { stroke: #004f6b; stroke-width: 2.5; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker
       id="arrowhead"
       markerWidth="10"
       markerHeight="7"
       refX="8"
       refY="3.5"
       orient="auto">
      <polygon
         points="0 0, 10 3.5, 0 7"
         fill="#004f6b"
         id="polygon1" />
    </marker>
  </defs>
  <text
     x="450"
     y="40"
     class="title"
     id="text1">BARQUE End-to-End Workflow</text>
  <rect
     x="230"
     y="70"
     width="440"
     height="70"
     class="step"
     id="rect1" />
  <text
     x="450"
     y="110"
     class="label"
     id="text2"><tspan
       x="450"
       dy="-20"
       id="tspan1">Start &amp; Run Logger</tspan><tspan
       x="450"
       dy="22"
       id="tspan2">Load configuration · copy config &amp; primer files to `99_logfiles`</tspan></text>
  <line
     x1="450"
     y1="140"
     x2="450"
     y2="190"
     class="arrow"
     id="line2" />
  <rect
     x="230"
     y="190"
     width="440"
     height="80"
     class="step"
     id="rect2" />
  <text
     x="450"
     y="230"
     class="label"
     id="text4"><tspan
       x="450"
       dy="-20"
       id="tspan3">Project Validation (`00_validate_project.sh`)</tspan><tspan
       x="450"
       dy="22"
       id="tspan4">Check folders, references, and unique sample IDs</tspan></text>
  <line
     x1="450"
     y1="270"
     x2="450"
     y2="320"
     class="arrow"
     id="line4" />
  <rect
     x="230"
     y="320"
     width="440"
     height="140"
     class="step optional"
     id="rect4" />
  <text
     x="450"
     y="365"
     class="label"
     id="text8"><tspan
       x="450"
       dy="-40"
       id="tspan5">Data Preparation (`SKIP_DATA_PREP = 0`)</tspan><tspan
       x="450"
       dy="28"
       id="tspan6">01 Trim &amp; quality-filter reads → `05_trimmed/`</tspan><tspan
       x="450"
       dy="24"
       id="tspan7">02 Merge paired-ends → `06_merged/`</tspan><tspan
       x="450"
       dy="24"
       id="tspan8">03 Split libraries by amplicon → `07_split_amplicons/`</tspan></text>
  <text
     x="450"
     y="450"
     class="note"
     id="text9">Skipped entirely when `SKIP_DATA_PREP = 1`</text>
  <line
     x1="450"
     y1="460"
     x2="450"
     y2="510"
     class="arrow"
     id="line9" />
  <rect
     x="230"
     y="510"
     width="440"
     height="90"
     class="step optional"
     id="rect9" />
  <text
     x="450"
     y="555"
     class="label"
     id="text10"><tspan
       x="450"
       dy="-22"
       id="tspan9">Chimera Handling (`05_chimeras.sh`)</tspan><tspan
       x="450"
       dy="24"
       id="tspan10">Flag or remove chimeric clusters (optional via `SKIP_CHIMERA_DETECTION`)</tspan></text>
  <line
     x1="450"
     y1="600"
     x2="450"
     y2="650"
     class="arrow"
     id="line10" />
  <rect
     x="230"
     y="650"
     width="440"
     height="80"
     class="step"
     id="rect10" />
  <text
     x="450"
     y="690"
     class="label"
     id="text12"><tspan
       x="450"
       dy="-20"
       id="tspan11">VSEARCH Taxonomic Assignment (`06_vsearch.sh`)</tspan><tspan
       x="450"
       dy="24"
       id="tspan12">Search merged reads against reference database → `09_vsearch/`</tspan></text>
  <line
     x1="450"
     y1="730"
     x2="450"
     y2="780"
     class="arrow"
     id="line12" />
  <rect
     x="230"
     y="780"
     width="440"
     height="80"
     class="step"
     id="rect12" />
  <text
     x="450"
     y="820"
     class="label"
     id="text14"><tspan
       x="450"
       dy="-20"
       id="tspan13">Summarise Per-Sample Hits (`07_summarize_results.py`)</tspan><tspan
       x="450"
       dy="24"
       id="tspan14">Filter by depth &amp; write reports to `12_results/`</tspan></text>
  <line
     x1="450"
     y1="860"
     x2="450"
     y2="910"
     class="arrow"
     id="line14" />
  <rect
     x="230"
     y="910"
     width="440"
     height="80"
     class="step"
     id="rect14" />
  <text
     x="450"
     y="950"
     class="label"
     id="text16"><tspan
       x="450"
       dy="-20"
       id="tspan15">Read Dropout Diagnostics (`08_summarize_read_dropout.sh`)</tspan><tspan
       x="450"
       dy="24"
       id="tspan16">Quantify lost reads &amp; coverage → `10_read_dropout/`</tspan></text>
  <line
     x1="450"
     y1="990"
     x2="450"
     y2="1040"
     class="arrow"
     id="line16" />
  <rect
     x="230"
     y="1040"
     width="440"
     height="80"
     class="step"
     id="rect16" />
  <text
     x="450"
     y="1080"
     class="label"
     id="text18"><tspan
       x="450"
       dy="-20"
       id="tspan17">Frequent Non-Annotated Reads (`09_get_most_frequent_non_annotated_sequences.sh`)</tspan><tspan
       x="450"
       dy="24"
       id="tspan18">Highlight unknown sequences → `11_non_annotated/`</tspan></text>
  <line
     x1="450"
     y1="1120"
     x2="450"
     y2="1170"
     class="arrow"
     id="line18" />
  <rect
     x="40"
     y="1120"
     width="320"
     height="110"
     class="step optional"
     id="rect18" />
  <text
     x="200"
     y="1170"
     class="label"
     id="text21"><tspan
       x="200"
       dy="-35"
       id="tspan19">OTU Construction (`SKIP_OTUS = 0`)</tspan><tspan
       x="200"
       dy="26"
       id="tspan20">Generate OTU database with vsearch</tspan><tspan
       x="200"
       dy="24"
       id="tspan21">Produce clustered FASTA &amp; tables</tspan></text>
  <line
     x1="450"
     y1="1120"
     x2="200"
     y2="1120"
     class="arrow"
     id="line21" />
  <rect
     x="230"
     y="1170"
     width="440"
     height="110"
     class="step"
     id="rect21" />
  <text
     x="450"
     y="1220"
     class="label"
     id="text24"><tspan
       x="450"
       dy="-35"
       id="tspan22">Multiple-Hit Deep Dive (`12_extract_multiple_hit_sequences.py`)</tspan><tspan
       x="450"
       dy="26"
       id="tspan23">Export database &amp; read sequences for ambiguous hits</tspan><tspan
       x="450"
       dy="24"
       id="tspan24">Supports manual curation &amp; OTU review</tspan></text>
  <line
     x1="450"
     y1="1280"
     x2="450"
     y2="1330"
     class="arrow"
     id="line24" />
  <rect
     x="230"
     y="1330"
     width="440"
     height="90"
     class="step"
     id="rect24" />
  <text
     x="450"
     y="1375"
     class="label"
     id="text26"><tspan
       x="450"
       dy="-22"
       id="tspan25">Similarity Visualisation (`util/similarity_by_species_graph.R`)</tspan><tspan
       x="450"
       dy="24"
       id="tspan26">Plot hit similarity per species &amp; site</tspan></text>
  <line
     x1="450"
     y1="1420"
     x2="450"
     y2="1470"
     class="arrow"
     id="line26" />
  <rect
     x="230"
     y="1470"
     width="440"
     height="70"
     class="step"
     id="rect26" />
  <text
     x="450"
     y="1510"
     class="label"
     id="text28"><tspan
       x="450"
       dy="-20"
       id="tspan27">Outputs Ready</tspan><tspan
       x="450"
       dy="24"
       id="tspan28">Reports, diagnostics, and optional OTU tables in `12_results/`</tspan></text>
</svg>
